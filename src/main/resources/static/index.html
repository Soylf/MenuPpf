<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ú–µ–Ω—é</title>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@500;700&display=swap" rel="stylesheet">

    <style>
        body {
          margin: 0;
          font-family: 'Playfair Display', serif;
          background-color: #FDFDFD;
          color: #1c1c1c;
        }

        .up-site {
          text-align: center;
          padding: 60px 30px;
          background-color: #f8f8f8;
        }

        .up-site h1 {
          color: #15154B;
          font-size: 42px;
          margin-bottom: 20px;
        }

        .up-description {
          max-width: 800px;
          margin: 0 auto;
          font-size: 18px;
          line-height: 1.7;
          color: #444;
        }

        .section {
          margin-top: 40px;
          text-align: left;
        }

        .section-title-button {
          display: flex;
          align-items: center;
          font-size: 24px;
          color: #343434;
          cursor: pointer;
          user-select: none;
          transition: color 0.3s ease;
        }

        .section-title-button:hover {
          color: #cc2b73;
        }

       .image-wrapper {
         position: relative;
         display: inline-block;
         margin-bottom: 20px;
       }

        .main-image {
         width: 100%;
         max-width: 1200px;
         height: auto;
         border-radius: 40px;
        }

        .avatar {
          width: 32px;
          height: 32px;
          display: inline-block;
          margin-right: 10px;
        }

        .emoji {
          font-size: 24px;
        }

        .avatar {
          display: none;
          border-radius: 50%;
          object-fit: cover;
        }

        .toggle-list {
          display: none;
          margin-top: 15px;
          padding-left: 20px;
        }

        /* –í—Ö–æ–¥ –≤ –∞–¥–º–∏–Ω–∫—É */
        .admin-lock {
          position: fixed;
          top: 16px;
          right: 16px;
          z-index: 1000;
          cursor: pointer;
        }

        .admin-lock img {
          width: 32px;
          height: 32px;
          transition: transform 0.3s ease;
        }

        .admin-lock:hover img {
          transform: scale(1.1);
        }

        /* –ú–µ–Ω—é —Å–∞–π—Ç–∞ */
        .menu-site {
          text-align: center;
          padding: 60px 30px;
          background-color: #FDFDFD;
        }

        .menu-grid {
          display: grid;
          grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
          gap: 20px;
          max-width: 1200px;
          margin: 0 auto;
        }

        .menu-item {
          background-color: #fff;
          padding: 20px;
          border-radius: 20px;
          box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
          transition: transform 0.3s ease, box-shadow 0.3s ease;
          overflow: hidden;
          position: relative;
          z-index: 1;
          max-weight: 150px;
        }

        .menu-item::before { /* –≠—Ñ—Ñ–µ–∫—Ç –ø–æ–¥–ª–æ–∂–∫–∏ */
         content: '';
         position: absolute;
         top: 0;
         left: 0;
         right: 0;
         bottom: 0;
         background: linear-gradient(to bottom, transparent, rgba(0, 0, 0, 0.05)), radial-gradient(circle at center, rgba(255, 255, 255, 0), rgba(255, 255, 255, 0.5));
         opacity: 0;
         transition: opacity 0.3s cubic-bezier(.25,.8,.25,1);
         pointer-events: none;
         z-index: -1;
        }

        .menu-item:hover::before {
         opacity: 1;
        }

        .menu-item:hover {
          transform: scale(1.05);
          box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2);
        }

        .menu-item img {
          width: 100%;
          height: auto;
          border-radius: 10px;
          object-fit: cover;
          margin-bottom: 15px;
        }
        .menu-item img:hover {
         filter: brightness(1.1);
         }

        .menu-item h3 {
          font-size: 18px;
          color: #343434;
          margin-bottom: 5px;
          word-break: break-word;
        }

        .menu-item p {
          font-size: 14px;
          color: #666;
          margin-bottom: 5px;
          word-warp: break-word;
        }

        .menu-item .price {
          font-size: 16px;
          font-weight: bold;
          color: #cc2b73;
          letter-spacing: 0.5px;
        }

        .hidden {
         display: none;
        }

       #cart-bar {
        position: fixed;
        bottom: 20px;
        right: 20px;
        background-color: #0B0B24;
        color: #fff;
        padding: 10px 20px;
        border-radius: 40px;
        font-size: 18px;
        font-weight: bold;
        cursor: pointer;
        box-shadow: 0 4px 8px rgba(0,0,0,0.3);
        display: flex;
        align-items: center;
        gap: 10px;
        z-index: 1000;
       }

        #cart-modal {
         position: fixed;
         top: 0;
         left: 0;
         right: 0;
         bottom: 0;
         background: rgba(0,0,0,0.5);
         display: none;
         justify-content: center;
         align-items: center;
         z-index: 1100;
        }

        .cart-modal-content {
         background: white;
         padding: 20px;
         border-radius: 20px;
         width: 90%;
         max-width: 400px;
        }

        #cart-modal:not(.hidden) {
         display: flex;
        }

        .cart-modal-content {
         background: white;
         padding: 30px;
         border-radius: 20px;
         width: 90%;
         max-width: 500px;
        }
    </style>
</head>
<body>

<div class="admin-lock" onclick="window.location.href='./adminPanel.html'">
    <img src="./imgIns/–ó–∞–º–æ—á–µ–∫ –¥–ª—è –∞–¥–º–∏–Ω–∫–∏.png" alt="–ê–¥–º–∏–Ω–∫–∞">
</div>

<div class="up-site">
    <div class="image-wrapper">
        <img src="./imgIns/t2.png" alt="–û—Å–Ω–æ–≤–Ω–æ–π —Ñ–æ–Ω" class="main-image">
    </div>

    <h1>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å</h1>

    <div class="up-description">
        <p>
            –ü–æ–≥—Ä—É–∑–∏—Ç–µ—Å—å –≤ –º–∏—Ä –∏–∑—ã—Å–∫–∞–Ω–Ω—ã—Ö –≤–∫—É—Å–æ–≤ –∏ –∞—Ä–æ–º–∞—Ç–æ–≤. –ù–∞—à–µ –º–µ–Ω—é ‚Äî —ç—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ –±–ª—é–¥–∞ –∏ –Ω–∞–ø–∏—Ç–∫–∏, –∞ –≥–∞—Å—Ç—Ä–æ–Ω–æ–º–∏—á–µ—Å–∫–∞—è –∏—Å—Ç–æ—Ä–∏—è, —Å–æ–∑–¥–∞–Ω–Ω–∞—è —Å –ª—é–±–æ–≤—å—é –∫ –¥–µ—Ç–∞–ª—è–º –∏ —É–≤–∞–∂–µ–Ω–∏–µ–º –∫ –≤–∞—à–µ–º—É –≤–∫—É—Å—É.
        </p>

        <div class="section">
            <div class="section-title-button" id="toggle-button">
                <span class="emoji" id="emoji">‚ö´</span>
                <img src="./imgIns/–î–ª—è –∞–≤–∞—Ç–∞—Ä–∫–∏ –ø–æ—á–µ–º—É –Ω–∞—Å...png" alt="–®–µ—Ñ" class="avatar" id="avatar">
                –ü–æ—á–µ–º—É –≤—ã–±–∏—Ä–∞—é—Ç –Ω–∞—Å?
            </div>
            <ul class="toggle-list" id="info-list">
                <li>–ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥ ‚Äî –º–µ–Ω—é –∞–¥–∞–ø—Ç–∏—Ä—É–µ—Ç—Å—è –ø–æ–¥ —Ñ–æ—Ä–º–∞—Ç –∏ –≤–∫—É—Å –≤–∞—à–µ–≥–æ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è.</li>
                <li>–°–≤–µ–∂–µ—Å—Ç—å –∏ –∫–∞—á–µ—Å—Ç–≤–æ ‚Äî –µ–¥–∞ –≥–æ—Ç–æ–≤–∏—Ç—Å—è –Ω–∞ –∑–∞–∫–∞–∑, –∏–∑ –æ—Ç–±–æ—Ä–Ω—ã—Ö –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–æ–≤.</li>
                <li>–≠—Å—Ç–µ—Ç–∏–∫–∞ ‚Äî –∫–∞–∂–¥–∞—è –¥–µ—Ç–∞–ª—å –ø—Ä–æ–¥—É–º–∞–Ω–∞, —á—Ç–æ–±—ã —Ä–∞–¥–æ–≤–∞—Ç—å –≥–ª–∞–∑ –∏ –≤–æ–∑–±—É–∂–¥–∞—Ç—å –∞–ø–ø–µ—Ç–∏—Ç.</li>
            </ul>
        </div>
    </div>
</div>

<div class="menu-site">
    <h2>–ù–∞—à–µ –º–µ–Ω—é</h2>
    <div id="menu-container"></div>
</div>

<div id="cart-bar" class="hidden">
    üõí <span>–¢–æ–≤–∞—Ä—ã –≤ –∫–æ—Ä–∑–∏–Ω–µ: <span id="cart-count">0</span></span>
    <span>–°—É–º–º–∞: <span id="cart-sum">0 ‚ÇΩ</span></span>
</div>


<div id="cart-modal" class="hidden">
    <div class="cart-modal-content">
        <h3>–ö–æ—Ä–∑–∏–Ω–∞</h3>
        <div id="cart-items"></div>
        <div>–û–±—â–∞—è —Å—É–º–º–∞: <span id="cart-total-sum">0 ‚ÇΩ</span></div>
        <button onclick="closeCartModal()">–ó–∞–∫—Ä—ã—Ç—å</button>
    </div>
</div>

<script>
    const toggleButton = document.getElementById('toggle-button');
    const infoList = document.getElementById('info-list');
    const emoji = document.getElementById('emoji');
    const avatar = document.getElementById('avatar');

    toggleButton.addEventListener('click', () => {
      const isOpen = infoList.style.display === 'block';
      infoList.style.display = isOpen ? 'none' : 'block';
      emoji.style.display = isOpen ? 'inline-block' : 'none';
      avatar.style.display = isOpen ? 'none' : 'inline-block';
    });

let cart = [];

function addToCart(item) {
  const existingItem = cart.find(cartItem => cartItem.id === item.id);
  if (existingItem) {
    existingItem.quantity += 1;
  } else {
    cart.push({...item, quantity: 1});
  }
  updateCartDisplay();
}

function updateCartDisplay() {
  const cartCount = cart.reduce((acc, item) => acc + item.quantity, 0);
  const cartSum = cart.reduce((acc, item) => acc + (item.price * item.quantity), 0);

  document.getElementById('cart-count').textContent = cartCount;
  document.getElementById('cart-sum').textContent = `${cartSum} ‚ÇΩ`;

  if (cartCount > 0) {
    document.getElementById('cart-bar').classList.remove('hidden');
  } else {
    document.getElementById('cart-bar').classList.add('hidden');
  }
}

document.addEventListener('click', function(event) {
  const button = event.target.closest('.add-to-cart-btn');
  if (button) {
    const item = {
      id: parseInt(button.getAttribute('data-id')), // –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º id –≤ —á–∏—Å–ª–æ
      name: button.getAttribute('data-name'),
      price: parseFloat(button.getAttribute('data-price'))
    };
    addToCart(item);
  }
});


    function groupByCategory(items) {
      return items.reduce((acc, currentItem) => {
        const categoryName = currentItem.category || '–ë–µ–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏';
        acc[categoryName] = [...(acc[categoryName] || []), currentItem];
        return acc;
      }, {});
    }

    function createCategorySection(categoryName, itemsInCategory) {
      const sectionContainer = document.createElement('section');
      sectionContainer.classList.add('category-section');

      const header = document.createElement('h2');
      header.textContent = categoryName;
      sectionContainer.appendChild(header);

      const menuGrid = document.createElement('div');
      menuGrid.classList.add('menu-grid');
      sectionContainer.appendChild(menuGrid);

      itemsInCategory.forEach(item => {
        const itemCard = document.createElement('div');
        itemCard.classList.add('menu-item');

        let imageUrl = item.image ? item.image : '/path/to/default-image.jpg';

        itemCard.innerHTML = `
          <div class="image-wrapper">
            <img src="${imageUrl}" alt="${item.name}" class="main-image">
          </div>
          <h3>${item.name}</h3>
          <p>${item.description || '–ù–µ —É–∫–∞–∑–∞–Ω–Ω–æ'}</p>
          <div style="display:flex; justify-content:space-between; align-items:center;">
            <p class="price">–¶–µ–Ω–∞: ${item.price} ‚ÇΩ</p>
            <button type="button" class="add-to-cart-btn" data-id="${item.id}" data-name="${item.name}" data-price="${item.price}">+</button>
            <div style="border-left: 1px solid #ccc; padding-left: 10px; font-size: 16px; color:#343434;">
              <strong>–ö–æ–ª–≤–æ:</strong> ${item.pieces || '–ù–µ —É–∫–∞–∑–∞–Ω–Ω–æ'}
              <br />
              <strong>–í–µ—Å:</strong> ${item.heft || '–ù–µ —É–∫–∞–∑–∞–Ω–Ω–æ'} –∫–∫–∞–ª
            </div>
          </div>
        `;

        menuGrid.appendChild(itemCard);
      });

      return sectionContainer;
    }

    function displayMenu(items) {
      const groupedItems = groupByCategory(items);
      const container = document.getElementById('menu-container');
      container.innerHTML = '';

      Object.keys(groupedItems).forEach(category => {
        const categorySection = createCategorySection(category, groupedItems[category]);
        container.appendChild(categorySection);
      });
    }

    async function fetchItems() {
      try {
        const response = await fetch('/admin/items');
        if (!response.ok) throw new Error(`–û—à–∏–±–∫–∞ HTTP (${response.status})`);

        const items = await response.json();
        displayMenu(items);
      } catch (err) {
        console.error("–û—à–∏–±–∫–∞:", err.message);
      }
    }

    fetchItems();
</script>

</body>
</html>